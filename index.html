<!DOCTYPE html>  
<html><head>  
<meta http-equiv='X-UA-Compatible' content='IE=edge' />  
<title>Hello World</title>  



<!--Standard sapui5 init-->
<script id='sap-ui-bootstrap' 
    src='https://openui5.hana.ondemand.com/resources/sap-ui-core.js'  
    data-sap-ui-theme='sap_bluecrystal'  
    data-sap-ui-libs='sap.m,sap.ui.commons'></script>   

<!--CSS required by open.m.Card
Needs to be after sapui5 init in order to override styles-->
<link href="openui5_cards.css" type="text/css" rel="stylesheet"/>

<script type="text/javascript">
//Component definitions in this script section
//- open.m.Card
//- open.m.CardContainer
sap.ui.core.Control.extend("open.m.Card", {
    metadata : {
        properties : {
            "title" : "string",
            "subtitle" : "string",
            "address": "string",
        },
        aggregations: {
            actions: {type : "open.m.CardAction", multiple : true},
        },
    },

    init: function() {

    },

    
    renderer : function(oRm, oControl) {
        oRm.write("<div"); 
        oRm.writeControlData(oControl);
        oRm.addClass("card"); 
        oRm.writeClasses();
        oRm.write(">");
        
        oRm.write("<h1>");
        //writing unescaped in order to get emphasis included
        //TODO: Is there a more intuitive way to define emphasis?
        oRm.write(oControl.getTitle());
        oRm.write("</h1>");

        oRm.write("<h2>");
        oRm.writeEscaped(oControl.getSubtitle());
        oRm.write("</h2>");

        oRm.write("<div class=\"map\" " +
            "style=\"background: url('http://maps.googleapis.com/maps/api/staticmap?center=" 
            + encodeURIComponent(oControl.getAddress()) + "&zoom=13&size=448x192&sensor=false') \">" + 
            "</div>");

        var vBoxActions = new sap.m.VBox({
            items:oControl.getActions()
        })
        
        oRm.renderControl(vBoxActions);

        oRm.write("</div>");
    }
});

sap.ui.core.Control.extend("open.m.CardAction", {
    metadata : {
        properties : {
            "icon" : {type : "sap.ui.core.URI", group : "Appearance", defaultValue : null},
            "actionText" : "string",
            "displayIcon": {type : "boolean", defaultValue : false},
        },
        aggregations: {
            "_actionIcon" : {type : "sap.ui.core.Icon", multiple : false, visibility: "hidden"},
            "_actionLink" : {type : "sap.m.Link", multiple : false, visibility: "hidden"}
        },
    },

    init: function() {

    },

    _initSubComponents: function(){
        this.setAggregation("_actionIcon", new sap.ui.core.Icon({
          src:this.getIcon(),
          color:"#4580f4",
          size: "1.6em",
          press: function(oEvent){
            alert('test1');
          }
        }).addStyleClass("actionIcon"));
        this.setAggregation("_actionLink", new sap.m.Link({
          text: this.getActionText(),
          press: function(oEvent){
            alert('test2');
          }
        }).addStyleClass("actionLink"));

    },
    
    renderer : function(oRm, oControl) {
        oControl._initSubComponents()

        var hBoxAction = new sap.m.HBox({
            fitContainer:true,
            items:[oControl.getAggregation("_actionIcon"),
                   oControl.getAggregation("_actionLink")]
        })   

        oRm.renderControl(hBoxAction);
    },
});


sap.ui.core.Control.extend("open.m.CardContainer", {
    metadata : {
        properties : {
            "value" : "string"
        },
        aggregations: {
            content: {type : "open.m.Card", multiple : true},
        },
    },

    init: function() {
        jQuery.sap.require("sap.ui.core.IconPool");
    },
    
    renderer : function(oRm, oControl) {
        oRm.write("<main");
        oRm.writeControlData(oControl);
        oRm.write(">");

        oRm.write("<header></header>");

        oRm.write("<input placeholder=\"Search\" x-webkit-speech autocomplete=\"off\" />")

        var aCards = oControl.getContent();
        for (var i = 0; i < aCards.length; i++){
            oRm.renderControl(aCards[i]);
        }
        
        oRm.write("</main>");
    }
});
</script>


<script> 
//Example of usage of the components in this section√ü
var card1 = new open.m.Card("card1", 
    {title:"<strong>32 minutes</strong> to destination in Norway", 
    subtitle:"This is the subtitle of my card1", 
    address:"Midthallet 10, Stavanger"});

var card2 = new open.m.Card("card2",
    {title:"<strong>4 days</strong> to destination in Palo Alto",
    subtitle:"This is the subtitle of my card2", 
    address:"SAP Palo alto",
    actions: [new open.m.CardAction("cardaction1",{actionText:"Navigate", icon:"sap-icon://locate-me"}),
              new open.m.CardAction("cardaction2",{actionText:"View email", icon:"sap-icon://email"})],
    });

var cardContainer = new open.m.CardContainer("myCardContainer", {
    content:[card1,card2]
});

cardContainer.placeAt('content') ;
</script>

</head>
<body class='sapUiBody'>
    <div id='content'></div>
</body>
</html>